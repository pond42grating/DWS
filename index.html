<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWS Fixed Rows - CSV Only</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .section {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .section h3 {
            margin-top: 0;
            background: #007bff;
            color: white;
            padding: 10px;
            border-radius: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        input {
            width: 95%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>DWS Fixed Rows Form</h1>
    <input type="file" id="upload" accept=".csv">
    <button id="import">Import CSV Data</button>

    <!-- Manpower Section -->
    <div class="section">
        <h3>Manpower</h3>
        <table id="manpower-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Trade</th>
                    <th>Name</th>
                    <th>Badge Number</th>
                    <th>Normal Hours</th>
                    <th>Overtime</th>
                    <th>Holiday</th>
                </tr>
            </thead>
            <tbody>
                <!-- 20 preset rows for Manpower -->
            </tbody>
        </table>
    </div>

    <!-- Equipment Section -->
    <div class="section">
        <h3>Equipment</h3>
        <table id="equipment-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Equipment Name</th>
                    <th>Working Hours</th>
                </tr>
            </thead>
            <tbody>
                <!-- 10 preset rows for Equipment -->
            </tbody>
        </table>
    </div>

    <!-- Materials Section -->
    <div class="section">
        <h3>Materials</h3>
        <table id="materials-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Description</th>
                    <th>Quantity</th>
                    <th>Unit (NOS/ML)</th>
                </tr>
            </thead>
            <tbody>
                <!-- 10 preset rows for Materials -->
            </tbody>
        </table>
    </div>

    <script>
        // Function to parse CSV data
        function parseCSV(csv) {
            const rows = csv.split('\n');
            const result = [];
            rows.forEach(row => {
                const columns = row.split(',');
                result.push(columns);
            });
            return result;
        }

        // Function to populate tables from parsed CSV data
        function populateDataFromCSV(data) {
            // Manpower: Rows 17-36, Columns 3-8
            populateManpowerRows(data.slice(16, 36));

            // Equipment: Rows 42-51, Columns 3 and 6
            populateEquipmentRows(data.slice(41, 51));

            // Materials: Rows 56-65, Columns 3, 7, and 10
            populateMaterialsRows(data.slice(55, 65));
        }

        // Function to populate the Manpower table
        function populateManpowerRows(data) {
            const table = document.getElementById("manpower-table");
            const rows = table.querySelectorAll("tbody tr");
            data.forEach((row, i) => {
                if (i < rows.length) {
                    const inputs = rows[i].querySelectorAll("input");
                    // Fill data into the appropriate columns (3-8)
                    inputs[1].value = row[2] || "";  // Trade
                    inputs[2].value = row[3] || "";  // Name
                    inputs[3].value = row[4] || "";  // Badge Number
                    inputs[4].value = row[5] || "";  // Normal Hours
                    inputs[5].value = row[6] || "";  // Overtime
                    inputs[6].value = row[7] || "";  // Holiday
                }
            });
        }

        // Function to populate the Equipment table
        function populateEquipmentRows(data) {
            const table = document.getElementById("equipment-table");
            const rows = table.querySelectorAll("tbody tr");
            data.forEach((row, i) => {
                if (i < rows.length) {
                    const inputs = rows[i].querySelectorAll("input");
                    // Fill data into the appropriate columns (3 and 6)
                    inputs[1].value = row[2] || "";  // Equipment Name
                    inputs[2].value = row[5] || "";  // Working Hours
                }
            });
        }

        // Function to populate the Materials table
        function populateMaterialsRows(data) {
            const table = document.getElementById("materials-table");
            const rows = table.querySelectorAll("tbody tr");
            data.forEach((row, i) => {
                if (i < rows.length) {
                    const inputs = rows[i].querySelectorAll("input");
                    // Fill data into the appropriate columns (3, 7, and 10)
                    inputs[1].value = row[2] || "";  // Description
                    inputs[2].value = row[6] || "";  // Quantity
                    inputs[3].value = row[9] || "";  // Unit (NOS/ML)
                }
            });
        }

        // Handle CSV file upload
        document.getElementById("upload").addEventListener("change", function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const csv = e.target.result;
                const parsedData = parseCSV(csv);
                populateDataFromCSV(parsedData);
            };
            reader.readAsText(file);
        });

        // Generate fixed rows for each section on page load
        window.onload = function() {
            generateRows("manpower-table", 20, ["Sl. No.", "Trade", "Name", "Badge Number", "Normal Hours", "Overtime", "Holiday"]);
            generateRows("equipment-table", 10, ["Sl. No.", "Equipment Name", "Working Hours"]);
            generateRows("materials-table", 10, ["Sl. No.", "Description", "Quantity", "Unit"]);
        };

        // Function to generate preset rows for a table
        function generateRows(tableId, numRows, columns) {
            let table = document.getElementById(tableId);
            let rows = "";
            for (let i = 1; i <= numRows; i++) {
                rows += `<tr><td>${i}</td>`;
                columns.slice(1).forEach(() => {
                    rows += `<td><input type="text"></td>`;
                });
                rows += "</tr>";
            }
            table.querySelector("tbody").innerHTML = rows;
        }
    </script>
</body>
</html>