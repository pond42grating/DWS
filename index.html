<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWS Management</title>
</head>
<body>
    <h1>Daily Work Schedule (DWS) Management</h1>

    <!-- Form to input DWS data -->
    <form id="dwsForm">
        <label for="structureName">Structure Name:</label>
        <input type="text" id="structureName" required><br><br>

        <label for="date">Date:</label>
        <input type="date" id="date" required><br><br>

        <label for="siNo">SI No:</label>
        <input type="text" id="siNo" required><br><br>

        <label for="workDescription">Work Description:</label>
        <input type="text" id="workDescription" required><br><br>

        <label for="location">Location:</label>
        <input type="text" id="location" required><br><br>

        <button type="button" onclick="saveData()">Save DWS Data</button>
    </form>

    <h2>Manpower</h2>
    <table id="manpowerTable" border="1">
        <thead>
            <tr>
                <th>Badge No</th>
                <th>Manpower Name</th>
                <th>Normal Hour</th>
                <th>OT Hour</th>
                <th>Holiday</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button onclick="addManpowerRow()">Add Manpower</button>

    <h2>Equipment</h2>
    <table id="equipmentTable" border="1">
        <thead>
            <tr>
                <th>Equipment Name</th>
                <th>Working Hours</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button onclick="addEquipmentRow()">Add Equipment</button>

    <h2>Consumables</h2>
    <table id="consumableTable" border="1">
        <thead>
            <tr>
                <th>Consumable Name</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button onclick="addConsumableRow()">Add Consumable</button>

    <h2>Saved DWS Data</h2>
    <pre id="savedData"></pre>

    <script>
        // Initialize a variable to keep track of DWS number (this could be stored in a database or localStorage in a real app)
        let dwsCounter = 1;
        const dwsData = []; // Array to store DWS entries

        // Function to generate DWS No automatically (e.g., DWS-001, DWS-002, ...)
        function generateDwsNo() {
            const dwsNo = `DWS-${String(dwsCounter).padStart(3, '0')}`;
            dwsCounter++; // Increment for the next DWS
            return dwsNo;
        }

        // Function to add a new row for Manpower
        function addManpowerRow() {
            const table = document.getElementById('manpowerTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="Badge No"></td>
                <td><input type="text" placeholder="Manpower Name"></td>
                <td><input type="number" placeholder="Normal Hour"></td>
                <td><input type="number" placeholder="OT Hour"></td>
                <td><input type="number" placeholder="Holiday"></td>
            `;
        }

        // Function to add a new row for Equipment
        function addEquipmentRow() {
            const table = document.getElementById('equipmentTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="Equipment Name"></td>
                <td><input type="number" placeholder="Working Hours"></td>
            `;
        }

        // Function to add a new row for Consumables
        function addConsumableRow() {
            const table = document.getElementById('consumableTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="Consumable Name"></td>
                <td><input type="number" placeholder="Quantity"></td>
            `;
        }

        // Function to save the DWS data
        function saveData() {
            // Generate DWS No automatically
            const dwsNo = generateDwsNo();

            // Get values from form inputs
            const structureName = document.getElementById('structureName').value;
            const date = document.getElementById('date').value;
            const siNo = document.getElementById('siNo').value;
            const workDescription = document.getElementById('workDescription').value;
            const location = document.getElementById('location').value;

            // Ensure all fields are filled before saving
            if (!structureName || !date || !siNo || !workDescription || !location) {
                alert('Please fill in all fields.');
                return;
            }

            // Collecting Manpower Data
            const manpower = [];
            const manpowerRows = document.getElementById('manpowerTable').rows;
            for (let i = 1; i < manpowerRows.length; i++) {
                const row = manpowerRows[i];
                manpower.push({
                    badgeNo: row.cells[0].querySelector('input').value,
                    manpowerName: row.cells[1].querySelector('input').value,
                    normalHour: row.cells[2].querySelector('input').value,
                    otHour: row.cells[3].querySelector('input').value,
                    holiday: row.cells[4].querySelector('input').value
                });
            }

            // Collecting Equipment Data
            const equipment = [];
            const equipmentRows = document.getElementById('equipmentTable').rows;
            for (let i = 1; i < equipmentRows.length; i++) {
                const row = equipmentRows[i];
                equipment.push({
                    equipmentName: row.cells[0].querySelector('input').value,
                    workingHours: row.cells[1].querySelector('input').value
                });
            }

            // Collecting Consumables Data
            const consumables = [];
            const consumableRows = document.getElementById('consumableTable').rows;
            for (let i = 1; i < consumableRows.length; i++) {
                const row = consumableRows[i];
                consumables.push({
                    consumableName: row.cells[0].querySelector('input').value,
                    quantity: row.cells[1].querySelector('input').value
                });
            }

            // Create the DWS object to store the data
            const dws = {
                dwsNo,
                structureName,
                date,
                siNo,
                workDescription,
                location,
                manpower,
                equipment,
                consumables
            };

            // Store the DWS data in the dwsData array
            dwsData.push(dws);

            // Clear the form fields after saving
            document.getElementById('structureName').value = '';
            document.getElementById('date').value = '';
            document.getElementById('siNo').value = '';
            document.getElementById('workDescription').value = '';
            document.getElementById('location').value = '';

            // Clear the tables after saving
            clearTable('manpowerTable');
            clearTable('equipmentTable');
            clearTable('consumableTable');

            // Show saved DWS data in the pre tag
            document.getElementById('savedData').textContent = JSON.stringify(dwsData, null, 2);

            alert(`DWS ${dwsNo} saved successfully!`);
        }

        // Function to clear the data in the tables after saving
        function clearTable(tableId) {
            const table = document.getElementById(tableId);
            const rows = table.rows;
            // Remove all rows except the header row
            for (let i = rows.length - 1; i > 0; i--) {
                table.deleteRow(i);
            }
        }
    </script>
</body>
</html>