<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Registration and Admin Control</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 500px;
            background: #ffffff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        label {
            display: block;
            margin-top: 10px;
            color: #555;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        button {
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .error {
            color: red;
            font-size: 14px;
        }

        .back-btn {
            cursor: pointer;
            color: #007BFF;
            font-size: 14px;
            text-decoration: underline;
        }

        .hidden { display: none; }

        .user-list {
            list-style-type: none;
            padding: 0;
        }

        .user-list li {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-list button {
            margin-left: 10px;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .approve-btn {
            background-color: green;
            color: white;
        }

        .reject-btn {
            background-color: red;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>User System</h1>
        <div id="authSection">
            <!-- Sign-In Section -->
            <div class="auth-section" id="signinSection">
                <h2>Sign In</h2>
                <label for="signinUsername">Username:</label>
                <input type="text" id="signinUsername" placeholder="Enter Username" required>

                <label for="signinPassword">Password:</label>
                <input type="password" id="signinPassword" placeholder="Enter Password" required>

                <button id="signinBtn">Sign In</button>
                <p class="error" id="signinError"></p>
                <button id="goToSignupBtn">Sign Up</button>
                <span class="back-btn" id="forgotPasswordBtn">Forgot Password?</span>
            </div>

            <!-- Sign-Up Section -->
            <div id="signupSection" class="auth-section hidden">
                <span class="back-btn" id="backToLoginBtn">← Back to Login</span>
                <h2>Sign Up</h2>
                <label for="signupUsername">Username:</label>
                <input type="text" id="signupUsername" placeholder="Enter Username" required>

                <label for="signupPassword">Password:</label>
                <input type="password" id="signupPassword" placeholder="Enter Password" required>

                <label for="secretCode">Secret Code:</label>
                <input type="text" id="secretCode" placeholder="Enter Secret Code" required>

                <button id="signupBtn">Sign Up</button>
                <p class="error" id="signupError"></p>
            </div>

            <!-- Forgot Password Section -->
            <div id="forgotPasswordSection" class="auth-section hidden">
                <span class="back-btn" id="backToLoginFromForgot">← Back to Login</span>
                <h2>Forgot Password</h2>
                <label for="forgotUsername">Enter Your Username:</label>
                <input type="text" id="forgotUsername" placeholder="Enter Username" required>

                <label for="forgotSecretCode">Enter Secret Code:</label>
                <input type="text" id="forgotSecretCode" placeholder="Enter Secret Code" required>

                <button id="resetPasswordBtn">Reset Password</button>
                <p class="error" id="forgotError"></p>
            </div>
        </div>

        <!-- Admin Dashboard Section -->
        <div id="adminDashboard" class="hidden">
            <h2>Admin Dashboard</h2>
            <p>Welcome, Admin! Here you can manage user sign-ups and approve or reject them.</p>
            <h3>Pending Sign-Ups</h3>
            <ul id="pendingUserList" class="user-list"></ul>
            <button id="logoutAdminBtn">Logout</button>
        </div>
    </div>

    <script>
        let users = JSON.parse(localStorage.getItem("users")) || [];

        const signinUsername = document.getElementById("signinUsername");
        const signinPassword = document.getElementById("signinPassword");
        const signupUsername = document.getElementById("signupUsername");
        const signupPassword = document.getElementById("signupPassword");
        const secretCode = document.getElementById("secretCode");
        const forgotUsername = document.getElementById("forgotUsername");
        const forgotSecretCode = document.getElementById("forgotSecretCode");

        const signinError = document.getElementById("signinError");
        const signupError = document.getElementById("signupError");
        const forgotError = document.getElementById("forgotError");

        const signinSection = document.getElementById("signinSection");
        const signupSection = document.getElementById("signupSection");
        const forgotPasswordSection = document.getElementById("forgotPasswordSection");
        const adminDashboard = document.getElementById("adminDashboard");
        const pendingUserList = document.getElementById("pendingUserList");

        document.getElementById("goToSignupBtn").addEventListener("click", () => {
            signinSection.classList.add("hidden");
            signupSection.classList.remove("hidden");
        });

        document.getElementById("backToLoginBtn").addEventListener("click", () => {
            signupSection.classList.add("hidden");
            signinSection.classList.remove("hidden");
        });

        document.getElementById("forgotPasswordBtn").addEventListener("click", () => {
            signinSection.classList.add("hidden");
            forgotPasswordSection.classList.remove("hidden");
        });

        document.getElementById("backToLoginFromForgot").addEventListener("click", () => {
            forgotPasswordSection.classList.add("hidden");
            signinSection.classList.remove("hidden");
            forgotUsername.value = '';
            forgotSecretCode.value = '';
            forgotError.textContent = '';
        });

        document.getElementById("signupBtn").addEventListener("click", () => {
            const username = signupUsername.value.trim();
            const password = signupPassword.value.trim();
            const secret = secretCode.value.trim();

            if (username && password && secret) {
                if (users.some(user => user.username === username)) {
                    signupError.textContent = "Username already exists.";
                } else {
                    users.push({ username, password, secretCode: secret, isApproved: false });
                    localStorage.setItem("users", JSON.stringify(users));
                    signupError.textContent = "Sign up successful! Await admin approval.";
                }
            } else {
                signupError.textContent = "Please fill in all fields.";
            }
        });

        // Sign-in
        document.getElementById("signinBtn").addEventListener("click", () => {
            const username = signinUsername.value.trim();
            const password = signinPassword.value.trim();

            if (username && password) {
                if (username === "heyman" && password === "12345678") {
                    alert("Admin login successful!");
                    signinSection.classList.add("hidden");
                    adminDashboard.classList.remove("hidden");
                    displayPendingUsers();
                    return;
                }

                const user = users.find(user => user.username === username && user.password === password && user.isApproved);
                if (user) {
                    alert("Login successful! Welcome to the project app.");
                } else {
                    signinError.textContent = "Invalid credentials or not approved by admin.";
                }
            } else {
                                signinError.textContent = "Please fill in all fields.";
            }
        });

        // Admin Logout
        document.getElementById("logoutAdminBtn").addEventListener("click", () => {
            adminDashboard.classList.add("hidden");
            signinSection.classList.remove("hidden");
        });

        // Display pending users
        function displayPendingUsers() {
            pendingUserList.innerHTML = '';
            const pendingUsers = users.filter(user => !user.isApproved);
            pendingUsers.forEach(user => {
                const li = document.createElement("li");
                li.innerHTML = `${user.username} (Pending Approval)`;
                const approveBtn = document.createElement("button");
                approveBtn.textContent = "Approve";
                approveBtn.classList.add("approve-btn");
                approveBtn.onclick = () => approveUser(user);
                
                const rejectBtn = document.createElement("button");
                rejectBtn.textContent = "Reject";
                rejectBtn.classList.add("reject-btn");
                rejectBtn.onclick = () => rejectUser(user);

                li.appendChild(approveBtn);
                li.appendChild(rejectBtn);
                pendingUserList.appendChild(li);
            });
        }

        // Approve user
        function approveUser(user) {
            user.isApproved = true;
            localStorage.setItem("users", JSON.stringify(users));
            displayPendingUsers(); // Refresh the list
        }

        // Reject user
        function rejectUser(user) {
            users = users.filter(u => u !== user);
            localStorage.setItem("users", JSON.stringify(users));
            displayPendingUsers(); // Refresh the list
        }

        // Reset Password
        document.getElementById("resetPasswordBtn").addEventListener("click", () => {
            const username = forgotUsername.value.trim();
            const secretCodeEntered = forgotSecretCode.value.trim();
            const user = users.find(u => u.username === username && u.secretCode === secretCodeEntered);
            if (user) {
                const newPassword = prompt("Enter your new password:");
                if (newPassword) {
                    user.password = newPassword;
                    localStorage.setItem("users", JSON.stringify(users));
                    alert("Password reset successful!");
                    forgotPasswordSection.classList.add("hidden");
                    signinSection.classList.remove("hidden");
                }
            } else {
                forgotError.textContent = "Username or secret code is incorrect.";
            }
        });
    </script>
</body>
</html>