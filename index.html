<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Work Entry Table</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
            text-align: left;
        }
        th, td {
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .form-section h3 {
            margin-bottom: 10px;
        }
        .form-section input, .form-section select, .form-section button {
            margin: 5px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-section button {
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        .form-section button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

    <h1>Work Entry Management</h1>

    <div class="form-section">
        <h3>Enter Work Details</h3>
        <label for="dwsNo">DWS No:</label>
        <input type="text" id="dwsNo" placeholder="Enter DWS No">
        
        <label for="date">Date:</label>
        <input type="date" id="date">

        <label for="sNo">S/No:</label>
        <input type="text" id="sNo" placeholder="Enter S/No">

        <label for="work">Work Description:</label>
        <input type="text" id="work" placeholder="Enter Work Description">

        <label for="location">Location:</label>
        <select id="location">
            <option value="Site">Site</option>
            <option value="Office">Office</option>
        </select>

        <h3>Manpower</h3>
        <label for="trade">Trade:</label>
        <input type="text" id="trade" placeholder="Enter Trade">
        
        <label for="name">Name:</label>
        <input type="text" id="name" placeholder="Enter Name">

        <label for="badgeNo">Badge No:</label>
        <input type="text" id="badgeNo" placeholder="Enter Badge No">

        <label for="nh">NH:</label>
        <input type="number" id="nh" placeholder="Enter NH">

        <label for="ot">OT:</label>
        <input type="number" id="ot" placeholder="Enter OT">

        <button onclick="addEntry()">Add Team</button>
    </div>

    <table id="previewTable">
        <thead>
            <tr>
                <th>Sl No</th>
                <th>DWS No</th>
                <th>Date</th>
                <th>S/No</th>
                <th>Work</th>
                <th>Location</th>
                <th>Trade</th>
                <th>Name</th>
                <th>Badge No</th>
                <th>NH</th>
                <th>OT</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <button onclick="exportToExcel()">Export to Excel</button>
    <button onclick="exportToPDF()">Export to PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script>
        const tableBody = document.querySelector("#previewTable tbody");

        function addEntry() {
            const dwsNo = document.getElementById("dwsNo").value;
            const date = document.getElementById("date").value;
            const sNo = document.getElementById("sNo").value;
            const work = document.getElementById("work").value;
            const location = document.getElementById("location").value;
            const trade = document.getElementById("trade").value;
            const name = document.getElementById("name").value;
            const badgeNo = document.getElementById("badgeNo").value;
            const nh = document.getElementById("nh").value;
            const ot = document.getElementById("ot").value;

            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${tableBody.rows.length + 1}</td>
                <td>${dwsNo}</td>
                <td>${date}</td>
                <td>${sNo}</td>
                <td>${work}</td>
                <td>${location}</td>
                <td>${trade}</td>
                <td>${name}</td>
                <td>${badgeNo}</td>
                <td>${nh}</td>
                <td>${ot}</td>
            `;
            tableBody.appendChild(row);

            // Clear fields after adding
            document.querySelectorAll(".form-section input").forEach(input => input.value = "");
        }

        function exportToExcel() {
            const wb = XLSX.utils.table_to_book(document.getElementById("previewTable"), { sheet: "Sheet1" });
            XLSX.writeFile(wb, "work_details.xlsx");
        }

        async function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();

            pdf.text("Work Details", 10, 10);
            pdf.autoTable({ html: "#previewTable" });

            pdf.save("work_details.pdf");
        }
    </script>

</body>
</html>