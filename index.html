<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create DWS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="createDwsPage">
        <h2>Create DWS</h2>

        <form id="dwsForm">
            <label for="date">Date:</label>
            <input type="date" id="date" required><br><br>

            <label for="structure">Structure Name:</label>
            <input type="text" id="structure" required><br><br>

            <label for="siNo">SI No.:</label>
            <input type="text" id="siNo" required><br><br>

            <label for="workDescription">Work Description:</label>
            <input type="text" id="workDescription" required><br><br>

            <label for="location">Location:</label>
            <input type="text" id="location" required><br><br>

            <!-- Manpower Section -->
            <h3>Manpower</h3>
            <div id="manpowerInput">
                <label for="manpowerName">Name:</label>
                <input type="text" id="manpowerName" placeholder="Enter Name">
                <label for="manpowerBadge">Badge No.:</label>
                <input type="text" id="manpowerBadge" placeholder="Enter Badge No.">
                <button type="button" onclick="addManpower()">Add Manpower</button>
            </div>
            <div id="manpowerPreview"></div>

            <!-- Equipment Section -->
            <h3>Equipment</h3>
            <div id="equipmentInput">
                <label for="equipmentName">Equipment Name:</label>
                <input type="text" id="equipmentName" placeholder="Enter Equipment Name">
                <label for="equipmentHours">Working Hours:</label>
                <input type="number" id="equipmentHours" placeholder="Enter Working Hours">
                <button type="button" onclick="addEquipment()">Add Equipment</button>
            </div>
            <div id="equipmentPreview"></div>

            <!-- Consumables Section -->
            <h3>Consumables</h3>
            <div id="consumablesInput">
                <label for="consumablesName">Consumable Name:</label>
                <input type="text" id="consumablesName" placeholder="Enter Consumable Name">
                <label for="consumablesQuantity">Quantity:</label>
                <input type="text" id="consumablesQuantity" placeholder="Enter Quantity">
                <button type="button" onclick="addConsumables()">Add Consumable</button>
            </div>
            <div id="consumablesPreview"></div>

            <button type="button" onclick="saveDws()">Save DWS</button>
        </form>

        <button onclick="goBack()">Back</button>
    </div>

    <script>
        let dwsNumber = 1; // Starting DWS number

        function addManpower() {
            const name = document.getElementById('manpowerName').value;
            const badge = document.getElementById('manpowerBadge').value;

            if (name && badge) {
                const manpowerPreview = document.createElement('div');
                manpowerPreview.textContent = `${badge} - ${name}`;
                document.getElementById('manpowerPreview').appendChild(manpowerPreview);

                // Clear the input fields
                document.getElementById('manpowerName').value = '';
                document.getElementById('manpowerBadge').value = '';
            }
        }

        function addEquipment() {
            const name = document.getElementById('equipmentName').value;
            const hours = document.getElementById('equipmentHours').value;

            if (name && hours) {
                const equipmentPreview = document.createElement('div');
                equipmentPreview.textContent = `${name} - ${hours} hrs`;
                document.getElementById('equipmentPreview').appendChild(equipmentPreview);

                // Clear the input fields
                document.getElementById('equipmentName').value = '';
                document.getElementById('equipmentHours').value = '';
            }
        }

        function addConsumables() {
            const name = document.getElementById('consumablesName').value;
            const quantity = document.getElementById('consumablesQuantity').value;

            if (name && quantity) {
                const consumablesPreview = document.createElement('div');
                consumablesPreview.textContent = `${name} - ${quantity}`;
                document.getElementById('consumablesPreview').appendChild(consumablesPreview);

                // Clear the input fields
                document.getElementById('consumablesName').value = '';
                document.getElementById('consumablesQuantity').value = '';
            }
        }

        function saveDws() {
            const date = document.getElementById('date').value;
            const structure = document.getElementById('structure').value;
            const siNo = document.getElementById('siNo').value;
            const workDescription = document.getElementById('workDescription').value;
            const location = document.getElementById('location').value;

            const manpower = [];
            document.querySelectorAll('#manpowerPreview div').forEach(div => {
                manpower.push(div.textContent);
            });

            const equipment = [];
            document.querySelectorAll('#equipmentPreview div').forEach(div => {
                equipment.push(div.textContent);
            });

            const consumables = [];
            document.querySelectorAll('#consumablesPreview div').forEach(div => {
                consumables.push(div.textContent);
            });

            const dwsData = {
                dwsNumber: dwsNumber++,
                date,
                structure,
                siNo,
                workDescription,
                location,
                manpower,
                equipment,
                consumables
            };

            let allDwsData = JSON.parse(localStorage.getItem('dwsData')) || [];
            allDwsData.push(dwsData);
            localStorage.setItem('dwsData', JSON.stringify(allDwsData));

            alert('DWS saved successfully!');
            goBack();
        }

        function goBack() {
            window.location.href = 'index.html'; // You can change this to navigate to the main page
        }
    </script>

</body>
</html>