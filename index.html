<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWS Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .container {
            width: 80%;
            margin: 50px auto;
        }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .nav-buttons button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        .section {
            display: none;
        }
        .form-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
            border: 1px solid #ccc;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px 12px;
            text-align: left;
        }
        button {
            padding: 8px 12px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            margin-right: 10px;
        }
        .back-btn {
            background-color: #f44336; /* Red color */
            margin-top: 20px;
        }
        .manpower-section, .equipment-section, .consumables-section {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Navigation Section -->
        <div class="nav-buttons" id="mainPage">
            <button onclick="switchSection('createDWSSection')">Create DWS</button>
            <button onclick="switchSection('manageDWSSection')">Manage DWS</button>
            <button onclick="switchSection('searchDWSSection')">Search DWS</button>
            <button onclick="switchSection('exportDWSSection')">Export DWS</button>
        </div>

        <!-- Create DWS Section -->
        <div id="createDWSSection" class="section">
            <h2>Create DWS</h2>
            <form id="createDWSForm">
                <input type="text" id="dwsNo" class="form-input" placeholder="DWS No." disabled>
                <input type="date" id="date" class="form-input" placeholder="Date">
                <input type="text" id="structureName" class="form-input" placeholder="Structure Name">
                <input type="text" id="siNo" class="form-input" placeholder="SI No.">
                <input type="text" id="workDescription" class="form-input" placeholder="Work Description">
                <input type="text" id="location" class="form-input" placeholder="Location">
                
                <!-- Manpower Section -->
                <h3>Manpower</h3>
                <div id="manpowerSection" class="manpower-section">
                    <input type="text" placeholder="Badge No." id="badgeNo">
                    <input type="text" placeholder="Name" id="manpowerName">
                    <input type="number" placeholder="Normal Hours" id="normalHours">
                    <input type="number" placeholder="OT Hours" id="otHours">
                    <input type="number" placeholder="Holiday Hours" id="holidayHours">
                    <button type="button" onclick="addManpower()">Add Manpower</button>
                </div>
                
                <!-- Equipment Section -->
                <h3>Equipment</h3>
                <div id="equipmentSection" class="equipment-section">
                    <input type="text" placeholder="Equipment Name" id="equipmentName">
                    <input type="number" placeholder="Working Hours" id="equipmentHours">
                    <button type="button" onclick="addEquipment()">Add Equipment</button>
                </div>
                
                <!-- Consumables Section -->
                <h3>Consumables/Materials</h3>
                <div id="consumablesSection" class="consumables-section">
                    <input type="text" placeholder="Consumable/Material Name" id="consumablesName">
                    <input type="number" placeholder="Quantity" id="consumablesQuantity">
                    <button type="button" onclick="addConsumables()">Add Consumable</button>
                </div>

                <button type="button" onclick="saveDWS()">Save DWS</button>
                <button type="button" class="back-btn" onclick="goBack()">Back</button>
            </form>
        </div>

        <!-- Manage DWS Section -->
        <div id="manageDWSSection" class="section">
            <h2>Manage DWS</h2>
            <table>
                <thead>
                    <tr>
                        <th>DWS No.</th>
                        <th>Date</th>
                        <th>Structure Name</th>
                        <th>SI No.</th>
                        <th>Work Description</th>
                        <th>Location</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="dwsTableBody">
                    <!-- Dynamic content will be added here -->
                </tbody>
            </table>
            <button class="back-btn" onclick="goBack()">Back</button>
        </div>

        <!-- Search DWS Section -->
        <div id="searchDWSSection" class="section">
            <h2>Search DWS</h2>
            <input type="number" id="searchDWSNo" class="form-input" placeholder="Enter DWS No.">
            <button type="button" id="searchDWSBtn">Search</button>
            <div id="searchResult"></div>
            <button class="back-btn" onclick="goBack()">Back</button>
        </div>

        <!-- Export DWS Section -->
        <div id="exportDWSSection" class="section">
            <h2>Export DWS</h2>
            <button id="exportToExcelBtn">Export to Excel</button>
            <button id="exportToPDFBtn">Export to PDF</button>
            <button class="back-btn" onclick="goBack()">Back</button>
        </div>
    </div>

    <script>
        let dwsData = JSON.parse(localStorage.getItem('dwsData')) || [];
        let nextDwsNo = dwsData.length ? Math.max(...dwsData.map(dws => dws.dwsNo)) + 1 : 1;

        // Switch to different sections
        function switchSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
            document.getElementById('mainPage').style.display = 'none';
        }

        // Go back to main page
        function goBack() {
            document.getElementById('mainPage').style.display = 'block';
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
        }

        // Add manpower data
        function addManpower() {
            const badgeNo = document.getElementById('badgeNo').value;
            const name = document.getElementById('manpowerName').value;
            const normalHours = document.getElementById('normalHours').value;
            const otHours = document.getElementById('otHours').value;
            const holidayHours = document.getElementById('holidayHours').value;

            if (badgeNo && name && normalHours && otHours && holidayHours) {
                let manpowerList = JSON.parse(localStorage.getItem('manpowerList')) || [];
                manpowerList.push({ badgeNo, name, normalHours, otHours, holidayHours });
                localStorage.setItem('manpowerList', JSON.stringify(manpowerList));
                alert("Manpower Added Successfully");
                document.getElementById('badgeNo').value = '';
                document.getElementById('manpowerName').value = '';
                document.getElementById('normalHours').value = '';
                document.getElementById('otHours').value = '';
                document.getElementById('holidayHours').value = '';
            } else {
                alert("Please fill all fields in Manpower section.");
            }
        }

        // Add equipment data
        function addEquipment() {
            const equipmentName = document.getElementById('equipmentName').value;
            const equipmentHours = document.getElementById('equipmentHours').value;

            if (equipmentName && equipmentHours) {
                let equipmentList = JSON.parse(localStorage.getItem('equipmentList')) || [];
                equipmentList.push({ equipmentName, equipmentHours });
                localStorage.setItem('equipmentList', JSON.stringify(equipmentList));
                alert("Equipment Added Successfully");
                document.getElementById('equipmentName').value = '';
                document.getElementById('equipmentHours').value = '';
            } else {
                alert("Please fill all fields in Equipment section.");
            }
        }

        // Add consumables data
        function addConsumables() {
            const consumablesName = document.getElementById('consumablesName').value;
            const consumablesQuantity = document.getElementById('consumablesQuantity').value;

            if (consumablesName && consumablesQuantity) {
                let consumablesList = JSON.parse(localStorage.getItem('consumablesList')) || [];
                consumablesList.push({ consumablesName, consumablesQuantity });
                localStorage.setItem('consumablesList', JSON.stringify(consumablesList));
                alert("Consumable Added Successfully");
                document.getElementById('consumablesName').value = '';
                document.getElementById('consumablesQuantity').value = '';
            } else {
                alert("Please fill all fields in Consumables section.");
            }
        }

        // Save DWS data
        function saveDWS() {
            const dws = {
                dwsNo: nextDwsNo,
                date: document.getElementById('date').value,
                structureName: document.getElementById('structureName').value,
                siNo: document.getElementById('siNo').value,
                workDescription: document.getElementById('workDescription').value,
                location: document.getElementById('location').value,
                manpower: JSON.parse(localStorage.getItem('manpowerList')) || [],
                equipment: JSON.parse(localStorage.getItem('equipmentList')) || [],
                consumables: JSON.parse(localStorage.getItem('consumablesList')) || []
            };

            dwsData.push(dws);
            localStorage.setItem('dwsData', JSON.stringify(dwsData));
            nextDwsNo++;

            // Clear local storage for lists
            localStorage.removeItem('manpowerList');
            localStorage.removeItem('equipmentList');
            localStorage.removeItem('consumablesList');

            // Clear form and switch to Manage DWS section
            document.getElementById('createDWSForm').reset();
            switchSection('manageDWSSection');
            loadDWSData();
        }

        // Load saved DWS data into table
        function loadDWSData() {
            const tbody = document.getElementById('dwsTableBody');
            tbody.innerHTML = '';
            dwsData.forEach(dws => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dws.dwsNo}</td>
                    <td>${dws.date}</td>
                    <td>${dws.structureName}</td>
                    <td>${dws.siNo}</td>
                    <td>${dws.workDescription}</td>
                    <td>${dws.location}</td>
                    <td>
                        <button onclick="editDWS(${dws.dwsNo})">Edit</button>
                        <button onclick="deleteDWS(${dws.dwsNo})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Delete a DWS entry
        function deleteDWS(dwsNo) {
            if (confirm('Are you sure you want to delete this DWS?')) {
                dwsData = dwsData.filter(dws => dws.dwsNo !== dwsNo);
                localStorage.setItem('dwsData', JSON.stringify(dwsData));
                loadDWSData();
            }
        }

        // Initial setup to load data
        loadDWSData();
    </script>
</body>
</html>