<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWS Fixed Rows</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
            margin-bottom: 30px;
        }
        .section h3 {
            margin-top: 0;
            background: #007bff;
            color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 14px;
        }
        table, th, td {
            border: 1px solid #ccc;
            padding: 10px;
        }
        th, td {
            text-align: left;
        }
        input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 5px 0;
        }
        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>DWS Fixed Rows Form</h1>
    <input type="file" id="upload" accept=".xlsx, .xls">
    <button id="import">Import Excel Data</button>

    <!-- Manpower Section -->
    <div class="section">
        <h3>Manpower</h3>
        <table id="manpower-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Trade</th>
                    <th>Name</th>
                    <th>Badge Number</th>
                    <th>Normal Hours</th>
                    <th>Overtime</th>
                    <th>Holiday</th>
                </tr>
            </thead>
            <tbody>
                <!-- 20 preset rows for Manpower -->
            </tbody>
        </table>
    </div>

    <!-- Equipment Section -->
    <div class="section">
        <h3>Equipment</h3>
        <table id="equipment-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Equipment Name</th>
                    <th>Working Hours</th>
                </tr>
            </thead>
            <tbody>
                <!-- 10 preset rows for Equipment -->
            </tbody>
        </table>
    </div>

    <!-- Materials Section -->
    <div class="section">
        <h3>Materials</h3>
        <table id="materials-table">
            <thead>
                <tr>
                    <th>Sl. No.</th>
                    <th>Description</th>
                    <th>Quantity</th>
                    <th>Unit (NOS/ML)</th>
                </tr>
            </thead>
            <tbody>
                <!-- 10 preset rows for Materials -->
            </tbody>
        </table>
    </div>

    <script>
        // Function to generate preset rows for a table, starting from the second column
        function generateRows(tableId, numRows, columns) {
            let table = document.getElementById(tableId);
            let rows = "";
            for (let i = 1; i <= numRows; i++) {
                rows += `<tr><td>${i}</td>`;
                columns.slice(1).forEach(() => {
                    rows += `<td><input type="text"></td>`;
                });
                rows += "</tr>";
            }
            table.querySelector("tbody").innerHTML = rows;
        }

        // Import Excel file and populate fields
        document.getElementById("upload").addEventListener("change", function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: "array" });

                // Extract data from the "Form" sheet
                const sheet = workbook.Sheets["Form"];
                const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                // Manpower (Rows 17 to 36, Columns 3 to 8)
                populateRows("manpower-table", json.slice(16, 36), ["Sl. No.", "Trade", "Name", "Badge Number", "Normal Hours", "Overtime", "Holiday"]);

                // Equipment (Rows 42 to 51, Columns 3 and 6)
                populateRows("equipment-table", json.slice(41, 51), ["Sl. No.", "Equipment Name", "Working Hours"]);

                // Materials (Rows 56 to 65, Columns 3, 7, and 10)
                populateRows("materials-table", json.slice(55, 65), ["Sl. No.", "Description", "Quantity", "Unit"]);
            };
            reader.readAsArrayBuffer(file);
        });

        function populateRows(tableId, data, columns) {
            const table = document.getElementById(tableId);
            const rows = table.querySelectorAll("tbody tr");
            data.forEach((row, i) => {
                if (i < rows.length) {
                    const inputs = rows[i].querySelectorAll("input");
                    // Insert data starting from the second column (index 1)
                    columns.slice(1).forEach((col, j) => {
                        inputs[j].value = row[j + 2] || "";  // Adjust index for proper column mapping
                    });
                }
            });
        }

        // Generate fixed rows for each section on page load
        window.onload = function() {
            generateRows("manpower-table", 20, ["Sl. No.", "Trade", "Name", "Badge Number", "Normal Hours", "Overtime", "Holiday"]);
            generateRows("equipment-table", 10, ["Sl. No.", "Equipment Name", "Working Hours"]);
            generateRows("materials-table", 10, ["Sl. No.", "Description", "Quantity", "Unit"]);
        };
    </script>
</body>
</html>