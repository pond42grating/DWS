<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWS Management System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPDF/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: auto;
        }

        .container {
            width: 80%;
            max-width: 1200px;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        input[type="text"], input[type="date"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        .list-preview {
            margin-top: 15px;
            padding: 10px;
            background-color: #f1f1f1;
            border-radius: 4px;
        }

        .list-preview ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .list-preview ul li {
            margin-bottom: 8px;
        }

        .form-container {
            margin-bottom: 30px;
        }

        /* Section for Manpower, Equipment, Consumables */
        .list-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }

        .list-container > div {
            flex: 1;
            max-height: 200px;
            overflow-y: auto;
        }

        .back-btn {
            margin-top: 20px;
            display: block;
            text-align: center;
            font-size: 16px;
            color: #007BFF;
            cursor: pointer;
        }

        .back-btn:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>DWS Management System</h1>

    <div class="form-container">
        <!-- Form for entering DWS data -->
        <div class="form-group">
            <label for="dwsNo">DWS No.</label>
            <input type="text" id="dwsNo" placeholder="Enter DWS No." required>
        </div>
        <div class="form-group">
            <label for="date">Date</label>
            <input type="date" id="date" required>
        </div>
        <div class="form-group">
            <label for="structureName">Structure Name</label>
            <input type="text" id="structureName" placeholder="Enter Structure Name" required>
        </div>
        <div class="form-group">
            <label for="siNo">SI No.</label>
            <input type="text" id="siNo" placeholder="Enter SI No." required>
        </div>
        <div class="form-group">
            <label for="workDescription">Work Description</label>
            <input type="text" id="workDescription" placeholder="Enter Work Description" required>
        </div>
        <div class="form-group">
            <label for="location">Location</label>
            <input type="text" id="location" placeholder="Enter Location" required>
        </div>

        <div class="list-container">
            <div class="manpower-list">
                <label for="manpower">Manpower</label>
                <input type="text" id="manpowerName" placeholder="Enter Manpower Name">
                <input type="text" id="manpowerBadgeNo" placeholder="Enter Badge No.">
                <input type="number" id="manpowerNormalHours" placeholder="Enter Normal Hours">
                <input type="number" id="manpowerOTHours" placeholder="Enter OT Hours">
                <button onclick="addManpower()">Add Manpower</button>
                <div class="list-preview" id="manpowerListPreview"></div>
            </div>

            <div class="equipment-list">
                <label for="equipment">Equipment</label>
                <input type="text" id="equipmentName" placeholder="Enter Equipment Name">
                <input type="number" id="equipmentWorkingHours" placeholder="Enter Working Hours">
                <button onclick="addEquipment()">Add Equipment</button>
                <div class="list-preview" id="equipmentListPreview"></div>
            </div>

            <div class="consumables-list">
                <label for="consumables">Consumables</label>
                <input type="text" id="consumableName" placeholder="Enter Consumable Name">
                <input type="number" id="consumableQuantity" placeholder="Enter Quantity">
                <button onclick="addConsumable()">Add Consumable</button>
                <div class="list-preview" id="consumableListPreview"></div>
            </div>
        </div>

        <button onclick="saveDWS()">Save DWS</button>
        <button onclick="exportToPDF()">Export to PDF</button>
        <button onclick="exportToExcel()">Export to Excel</button>
    </div>

    <!-- Back to Main Page Button -->
    <div class="back-btn" onclick="goBack()">Back to Main Page</div>
</div>

<script>
    let manpowerList = [];
    let equipmentList = [];
    let consumableList = [];

    // Function to add manpower details to list
    function addManpower() {
        const name = document.getElementById('manpowerName').value;
        const badgeNo = document.getElementById('manpowerBadgeNo').value;
        const normalHours = document.getElementById('manpowerNormalHours').value;
        const otHours = document.getElementById('manpowerOTHours').value;

        if (name && badgeNo && normalHours && otHours) {
            manpowerList.push(`${badgeNo} - ${name} - Normal: ${normalHours}hrs, OT: ${otHours}hrs`);
            updateManpowerPreview();
        }
    }

    // Function to add equipment details to list
    function addEquipment() {
        const equipmentName = document.getElementById('equipmentName').value;
        const workingHours = document.getElementById('equipmentWorkingHours').value;

        if (equipmentName && workingHours) {
            equipmentList.push(`${equipmentName} - Working Hours: ${workingHours}`);
            updateEquipmentPreview();
        }
    }

    // Function to add consumable details to list
    function addConsumable() {
        const consumableName = document.getElementById('consumableName').value;
        const quantity = document.getElementById('consumableQuantity').value;

        if (consumableName && quantity) {
            consumableList.push(`${consumableName} - Quantity: ${quantity}`);
            updateConsumablePreview();
        }
    }

    // Update the preview lists for manpower
    function updateManpowerPreview() {
        const previewDiv = document.getElementById('manpowerListPreview');
        previewDiv.innerHTML = '';
        manpowerList.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            previewDiv.appendChild(li);
        });
    }

    // Update the preview lists for equipment
    function updateEquipmentPreview() {
        const previewDiv = document.getElementById('equipmentListPreview');
        previewDiv.innerHTML = '';
        equipmentList.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            previewDiv.appendChild(li);
        });
    }

    // Update the preview lists for consumables
    function updateConsumablePreview() {
        const previewDiv = document.getElementById('consumableListPreview');
        previewDiv.innerHTML = '';
        consumableList.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            previewDiv.appendChild(li);
        });
    }

    // Function to save DWS
    function saveDWS() {
        const dwsData = {
            "DWS No.": document.getElementById('dwsNo').value,
            "Date": document.getElementById('date').value,
            "Structure Name": document.getElementById('structureName').value,
            "SI No.": document.getElementById('siNo').value,
            "Work Description": document.getElementById('workDescription').value,
            "Location": document.getElementById('location').value,
            "Manpower": manpowerList.join(", "),
            "Equipment": equipmentList.join(", "),
            "Consumables": consumableList.join(", ")
        };

        localStorage.setItem("dwsData", JSON.stringify(dwsData));
        alert("DWS Saved Successfully!");
    }

    // Export to PDF
    function exportToPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        doc.text("DWS No.: " + document.getElementById('dwsNo').value, 20, 30);
        doc.text("Date: " + document.getElementById('date').value, 20, 40);
        doc.text("Structure Name: " + document.getElementById('structureName').value, 20, 50);
        doc.text("SI No.: " + document.getElementById('siNo').value, 20, 60);
        doc.text("Work Description: " + document.getElementById('workDescription').value, 20, 70);
        doc.text("Location: " + document.getElementById('location').value, 20, 80);

        doc.text("Manpower:", 20, 100);
        manpowerList.forEach((manpower, index) => {
            doc.text(`${index + 1}. ${manpower}`, 20, 110 + (index * 10));
        });

        doc.text("Equipment:", 20, 130 + (manpowerList.length * 10));
        equipmentList.forEach((equipment, index) => {
            doc.text(`${index + 1}. ${equipment}`, 20, 140 + (manpowerList.length * 10) + (index * 10));
        });

        doc.text("Consumables:", 20, 160 + (manpowerList.length * 10) + (equipmentList.length * 10));
        consumableList.forEach((consumable, index) => {
            doc.text(`${index + 1}. ${consumable}`, 20, 170 + (manpowerList.length * 10) + (equipmentList.length * 10) + (index * 10));
        });

        doc.save('dws_report.pdf');
    }

    // Export to Excel
    function exportToExcel() {
        let data = [];
        const dwsData = {
            "DWS No.": document.getElementById('dwsNo').value,
            "Date": document.getElementById('date').value,
            "Structure Name": document.getElementById('structureName').value,
            "SI No.": document.getElementById('siNo').value,
            "Work Description": document.getElementById('workDescription').value,
            "Location": document.getElementById('location').value,
            "Manpower": manpowerList.join(", "),
            "Equipment": equipmentList.join(", "),
            "Consumables": consumableList.join(", ")
        };

        data.push(dwsData);

        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'DWS Report');
        XLSX.writeFile(wb, 'dws_report.xlsx');
    }

    // Go back to the main page
    function goBack() {
        window.location.reload();
    }

    // Display saved DWS data
    displayDWS();
</script>

</body>
</html>